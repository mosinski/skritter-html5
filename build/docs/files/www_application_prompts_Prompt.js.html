<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>www/application/prompts/Prompt.js - skritter-html5</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="skritter-html5"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.2632</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Analytics.html">Analytics</a></li>
            
                <li><a href="../classes/Api.html">Api</a></li>
            
                <li><a href="../classes/Application.html">Application</a></li>
            
                <li><a href="../classes/Assets.html">Assets</a></li>
            
                <li><a href="../classes/BaseApplication.html">BaseApplication</a></li>
            
                <li><a href="../classes/BaseCollection.html">BaseCollection</a></li>
            
                <li><a href="../classes/BaseModel.html">BaseModel</a></li>
            
                <li><a href="../classes/BasePage.html">BasePage</a></li>
            
                <li><a href="../classes/BaseRouter.html">BaseRouter</a></li>
            
                <li><a href="../classes/BaseView.html">BaseView</a></li>
            
                <li><a href="../classes/Bootstrap.html">Bootstrap</a></li>
            
                <li><a href="../classes/CanvasCharacter.html">CanvasCharacter</a></li>
            
                <li><a href="../classes/CanvasStroke.html">CanvasStroke</a></li>
            
                <li><a href="../classes/CharacterEditor.html">CharacterEditor</a></li>
            
                <li><a href="../classes/DataDecomp.html">DataDecomp</a></li>
            
                <li><a href="../classes/DataDecomps.html">DataDecomps</a></li>
            
                <li><a href="../classes/DataItem.html">DataItem</a></li>
            
                <li><a href="../classes/DataItems.html">DataItems</a></li>
            
                <li><a href="../classes/DataParam.html">DataParam</a></li>
            
                <li><a href="../classes/DataParams.html">DataParams</a></li>
            
                <li><a href="../classes/DataReview.html">DataReview</a></li>
            
                <li><a href="../classes/DataReviews.html">DataReviews</a></li>
            
                <li><a href="../classes/DataSentence.html">DataSentence</a></li>
            
                <li><a href="../classes/DataSentences.html">DataSentences</a></li>
            
                <li><a href="../classes/DataSRSConfig.html">DataSRSConfig</a></li>
            
                <li><a href="../classes/DataSRSConfigs.html">DataSRSConfigs</a></li>
            
                <li><a href="../classes/DataStroke.html">DataStroke</a></li>
            
                <li><a href="../classes/DataStrokes.html">DataStrokes</a></li>
            
                <li><a href="../classes/DataVocab.html">DataVocab</a></li>
            
                <li><a href="../classes/DataVocabList.html">DataVocabList</a></li>
            
                <li><a href="../classes/DataVocabLists.html">DataVocabLists</a></li>
            
                <li><a href="../classes/DataVocabs.html">DataVocabs</a></li>
            
                <li><a href="../classes/Dialogs.html">Dialogs</a></li>
            
                <li><a href="../classes/IndexedDBAdapter.html">IndexedDBAdapter</a></li>
            
                <li><a href="../classes/Kana.html">Kana</a></li>
            
                <li><a href="../classes/ListRowTable.html">ListRowTable</a></li>
            
                <li><a href="../classes/ListSectionTable.html">ListSectionTable</a></li>
            
                <li><a href="../classes/ListTable.html">ListTable</a></li>
            
                <li><a href="../classes/Mapper.html">Mapper</a></li>
            
                <li><a href="../classes/PageAccount.html">PageAccount</a></li>
            
                <li><a href="../classes/PageCreateAccount.html">PageCreateAccount</a></li>
            
                <li><a href="../classes/PageDashboard.html">PageDashboard</a></li>
            
                <li><a href="../classes/PageExport.html">PageExport</a></li>
            
                <li><a href="../classes/PageFilters.html">PageFilters</a></li>
            
                <li><a href="../classes/PageLanding.html">PageLanding</a></li>
            
                <li><a href="../classes/PageLanguageSelect.html">PageLanguageSelect</a></li>
            
                <li><a href="../classes/PageLearningCenter.html">PageLearningCenter</a></li>
            
                <li><a href="../classes/PageList.html">PageList</a></li>
            
                <li><a href="../classes/PageLists.html">PageLists</a></li>
            
                <li><a href="../classes/PageListSection.html">PageListSection</a></li>
            
                <li><a href="../classes/PageListSelect.html">PageListSelect</a></li>
            
                <li><a href="../classes/PageLogin.html">PageLogin</a></li>
            
                <li><a href="../classes/PageScratchpad.html">PageScratchpad</a></li>
            
                <li><a href="../classes/PageSettings.html">PageSettings</a></li>
            
                <li><a href="../classes/PageStats.html">PageStats</a></li>
            
                <li><a href="../classes/PageStrokeOrder.html">PageStrokeOrder</a></li>
            
                <li><a href="../classes/PageStudy.html">PageStudy</a></li>
            
                <li><a href="../classes/PageTests.html">PageTests</a></li>
            
                <li><a href="../classes/PageWords.html">PageWords</a></li>
            
                <li><a href="../classes/ParamEditor.html">ParamEditor</a></li>
            
                <li><a href="../classes/Params.html">Params</a></li>
            
                <li><a href="../classes/PinyinConverter.html">PinyinConverter</a></li>
            
                <li><a href="../classes/Prompt.html">Prompt</a></li>
            
                <li><a href="../classes/PromptCanvas.html">PromptCanvas</a></li>
            
                <li><a href="../classes/PromptController.html">PromptController</a></li>
            
                <li><a href="../classes/PromptDefn.html">PromptDefn</a></li>
            
                <li><a href="../classes/PromptGradingButtons.html">PromptGradingButtons</a></li>
            
                <li><a href="../classes/PromptRdng.html">PromptRdng</a></li>
            
                <li><a href="../classes/PromptRune.html">PromptRune</a></li>
            
                <li><a href="../classes/PromptTone.html">PromptTone</a></li>
            
                <li><a href="../classes/Recognizer.html">Recognizer</a></li>
            
                <li><a href="../classes/Router.html">Router</a></li>
            
                <li><a href="../classes/RouterAccountCreation.html">RouterAccountCreation</a></li>
            
                <li><a href="../classes/RouterAdmin.html">RouterAdmin</a></li>
            
                <li><a href="../classes/RouterLearningCenter.html">RouterLearningCenter</a></li>
            
                <li><a href="../classes/ScheduleItem.html">ScheduleItem</a></li>
            
                <li><a href="../classes/ScheduleItems.html">ScheduleItems</a></li>
            
                <li><a href="../classes/Shortstraw.html">Shortstraw</a></li>
            
                <li><a href="../classes/Sidebars.html">Sidebars</a></li>
            
                <li><a href="../classes/Strokes.html">Strokes</a></li>
            
                <li><a href="../classes/Timer.html">Timer</a></li>
            
                <li><a href="../classes/TimerStopwatch.html">TimerStopwatch</a></li>
            
                <li><a href="../classes/User.html">User</a></li>
            
                <li><a href="../classes/UserData.html">UserData</a></li>
            
                <li><a href="../classes/UserSettings.html">UserSettings</a></li>
            
                <li><a href="../classes/UserStats.html">UserStats</a></li>
            
                <li><a href="../classes/UserSubscription.html">UserSubscription</a></li>
            
                <li><a href="../classes/VocabTable.html">VocabTable</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Application.html">Application</a></li>
            
                <li><a href="../modules/Components.html">Components</a></li>
            
                <li><a href="../modules/Framework.html">Framework</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: www/application/prompts/Prompt.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module Application
 */
define([
    &#x27;framework/BaseView&#x27;
], function(BaseView) {
    /**
     * @class Prompt
     * @extends {BaseView}
     */
    var Prompt = BaseView.extend({
        /**
         * @method initialize
         * @param {Object} [options]
         * @param {PromptController} controller
         * @param {DataReview} review
         * @constructor
         */
        initialize: function(options, controller, review) {
            this.canvas = controller.canvas;
            this.containedVocab = undefined;
            this.controller = controller;
            this.gradingButtons = controller.gradingButtons;
            this.item = review.getBaseItem();
            this.part = review.get(&#x27;part&#x27;);
            this.position = 1;
            this.promptClick = true;
            this.review = review;
            this.teaching = false;
            this.vocab = review.getBaseVocab();
            //load canvas characters for rune and tone prompts
            if ([&#x27;rune&#x27;, &#x27;tone&#x27;].indexOf(this.part) !== -1 &amp;&amp; !review.characters.length) {
                review.characters = this.item.getCanvasCharacters();
            }
            //show tutorial if not already disabled
            if (app.user.settings.hasTutorial(this.part)) {
                app.dialogs.show(&#x27;tutorial-&#x27; + this.part);
                app.dialogs.element(&#x27;.tutorial-reading&#x27;).html(this.vocab.getReading());
                app.dialogs.element(&#x27;.tutorial-writing&#x27;).html(this.vocab.getWriting());
                app.dialogs.element(&#x27;.tutorial-disable&#x27;).on(&#x27;vclick&#x27;, _.bind(this.disableTutorial, this));
            }
        },
        /**
         * @property el
         * @type String
         */
        el: &#x27;.detail-container&#x27;,
        /**
         * @method render
         * @returns {Prompt}
         */
        render: function() {
            this.position = this.review.getPosition();
            this.containedVocab = this.review.getVocab();
            this.character = this.review.getCharacter();
            this.tones = this.vocab.getTones(this.position);
            console.log(&#x27;PROMPT:&#x27;, this.review.get(&#x27;itemId&#x27;), this.review, this.vocab);
            this.renderElements();
            if (this.review.getAt(&#x27;answered&#x27;)) {
                this.renderAnswer();
            } else {
                this.renderQuestion();
            }
            if (this.item.isNew()) {
                this.elements.promptNewness.text(&#x27;NEW&#x27;);
                this.elements.promptNewness.addClass(&#x27;text-warning&#x27;);
            } else {
                this.elements.promptNewness.text(&#x27;&#x27;);
            }
            if (this.vocab.isChinese()) {
                this.elements.promptStyle.text(this.vocab.getStyle().toUpperCase());
            }
            if (this.vocab.getAudio()) {
                $(&#x27;#button-audio&#x27;).removeClass(&#x27;inactive&#x27;);
            } else {
                $(&#x27;#button-audio&#x27;).addClass(&#x27;inactive&#x27;);
            }
            this.reset().resize();
            if (this.teaching) {
                this.teach();
            }
            this.updateVocabSidebar();
            this.loadFont();
            return this;
        },
        /**
         * @method renderAnswer
         * @returns {Prompt}
         */
        renderAnswer: function() {
            app.timer.stop();
            this.clickTimeout();
            this.review.setAt({
                answered: true,
                reviewTime: app.timer.getReviewTime(),
                thinkingTime: app.timer.getThinkingTime()
            });
            this.gradingButtons.select(this.review.getAt(&#x27;score&#x27;)).show();
            if (app.user.settings.hasTutorial(&#x27;grading&#x27;)) {
                app.dialogs.show(&#x27;tutorial-grading&#x27;);
                app.dialogs.element(&#x27;.tutorial-disable&#x27;).on(&#x27;vclick&#x27;, function() {
                    app.user.settings.disableTutorial(&#x27;grading&#x27;);
                    app.dialogs.hide();
                });
            }
            this.showNavigation(1.0);
            return this;
        },
        /**
         * @method renderElements
         * @returns {Prompt}
         */
        renderElements: function() {
            this.elements.buttonWrong = this.$(&#x27;.button-wrong&#x27;);
            this.elements.fieldAnswer = this.$(&#x27;.field-answer&#x27;);
            this.elements.fieldDefinition = this.$(&#x27;.field-definition&#x27;);
            this.elements.fieldHeisig = this.$(&#x27;.field-heisig&#x27;);
            this.elements.fieldHelpText = this.$(&#x27;.field-help-text&#x27;);
            this.elements.fieldHighlight = this.$(&#x27;.field-highlight&#x27;);
            this.elements.fieldJapaneseDefinition = this.$(&#x27;.field-japanese-definition&#x27;);
            this.elements.fieldMnemonic = this.$(&#x27;.field-mnemonic&#x27;);
            this.elements.fieldQuestion = this.$(&#x27;.field-question&#x27;);
            this.elements.fieldReading = this.$(&#x27;.field-reading&#x27;);
            this.elements.fieldWriting = this.$(&#x27;.field-writing&#x27;);
            this.elements.infoBan = $(&#x27;#sidebar-info .info-ban&#x27;);
            this.elements.infoContained = $(&#x27;#sidebar-info .info-contained&#x27;);
            this.elements.infoDecomps = $(&#x27;#sidebar-info .info-decomps&#x27;);
            this.elements.infoDefinition = $(&#x27;#sidebar-info .info-definition&#x27;);
            this.elements.infoHeisig = $(&#x27;#sidebar-info .info-heisig&#x27;);
            this.elements.infoMnemonic = $(&#x27;#sidebar-info .info-mnemonic&#x27;);
            this.elements.infoPleco = $(&#x27;#sidebar-info .info-pleco&#x27;);
            this.elements.infoReading = $(&#x27;#sidebar-info .info-reading&#x27;);
            this.elements.infoStar = $(&#x27;#sidebar-info .info-star&#x27;);
            this.elements.infoWriting = $(&#x27;#sidebar-info .info-writing&#x27;);
            this.elements.promptNewness = this.$(&#x27;.prompt-newness&#x27;);
            this.elements.promptStyle = this.$(&#x27;.prompt-style&#x27;);
            this.elements.promptText = this.$(&#x27;.prompt-text&#x27;);
            return this;
        },
        /**
         * @method renderQuestion
         * @returns {Prompt}
         */
        renderQuestion: function() {
            app.timer.setLapOffset(this.review.getAt(&#x27;reviewTime&#x27;));
            app.timer.start();
            this.review.setAt(&#x27;answered&#x27;, false);
            this.gradingButtons.hide();
            if (app.user.reviews.previous || !this.review.isFirst()) {
                this.showNavigation(0.2);
            } else {
                this.hideNavigation();
            }
            return this;
        },
        /**
         * @method events
         * @returns {Object}
         */
        events: _.extend({}, BaseView.prototype.events, {
            &#x27;swipeleft&#x27;: &#x27;handleSwipedLeft&#x27;,
            &#x27;vclick&#x27;: &#x27;handlePromptClicked&#x27;,
            &#x27;vclick .audio-button&#x27;: &#x27;handleAudioButtonClicked&#x27;,
            &#x27;vclick .button-wrong&#x27;: &#x27;handleWrongButtonClicked&#x27;,
            &#x27;vclick .reading-button&#x27;: &#x27;handleReadingButtonClicked&#x27;
        }),
        /**
         * @method clickTimeout
         * @param {Number} [milliseconds]
         */
        clickTimeout: function(milliseconds) {
            var self = this;
            milliseconds = milliseconds || 200;
            this.promptClick = false;
            setTimeout(function() {
                self.promptClick = true;
            }, milliseconds);
        },
        /**
         * @method disableTutorial
         */
        disableTutorial: function() {
            app.user.settings.disableTutorial(this.part);
            app.dialogs.hide();
        },
        /**
         * @method editDefinition
         */
        editDefinition: function() {
            var self = this;
            //TODO: clean up interactions with sidebar
            app.dialogs.show(&#x27;edit-text&#x27;).element(&#x27;.modal-title span&#x27;).text(&#x27;Edit Definition&#x27;);
            var currentDefinition = this.vocab.getDefinition(true);
            app.dialogs.element(&#x27;.dialog-value&#x27;).val(currentDefinition);
            app.dialogs.element(&#x27;.save&#x27;).on(&#x27;vclick&#x27;, function() {
                var value = app.dialogs.element(&#x27;.dialog-value&#x27;).val();
                if (!value || value === &#x27;&#x27;) {
                    value = currentDefinition;
                    self.vocab.set(&#x27;customDefinition&#x27;, undefined);
                } else if (currentDefinition !== value) {
                    self.vocab.set(&#x27;customDefinition&#x27;, value);
                } else {
                    value = currentDefinition;
                }
                $(&#x27;#sidebar-info .info-definition&#x27;).text(value);
                self.render();
                app.dialogs.hide();
            });
        },
        /**
         * @method editDefinition
         */
        editMnemonic: function() {
            var self = this;
            //TODO: clean up interactions with sidebar
            app.dialogs.show(&#x27;edit-text&#x27;).element(&#x27;.modal-title span&#x27;).text(&#x27;Edit Mnemonic&#x27;);
            var currentMnemonic = this.containedVocab.get(&#x27;mnemonic&#x27;) ? this.containedVocab.get(&#x27;mnemonic&#x27;).text : &#x27;&#x27;;
            app.dialogs.element(&#x27;.dialog-value&#x27;).empty();
            app.dialogs.element(&#x27;.dialog-value&#x27;).val(currentMnemonic);
            app.dialogs.element(&#x27;.save&#x27;).on(&#x27;vclick&#x27;, function() {
                var value = app.dialogs.element(&#x27;.dialog-value&#x27;).val();
                if (!value || value === &#x27;&#x27;) {
                    value = &#x27;&#x27;;
                    self.containedVocab.set(&#x27;mnemonic&#x27;, &#x27;&#x27;);
                } else if (currentMnemonic !== value) {
                    if (self.containedVocab.get(&#x27;mnemonic&#x27;)) {
                        self.containedVocab.get(&#x27;mnemonic&#x27;).text = value;
                        self.containedVocab.set(&#x27;mnemonic&#x27;, self.vocab.get(&#x27;mnemonic&#x27;));
                        self.containedVocab.cache();
                    } else {
                        self.containedVocab.set(&#x27;mnemonic&#x27;, {text: value, public: false});
                    }
                } else {
                    value = currentMnemonic;
                }
                $(&#x27;#sidebar-info .info-mnemonic&#x27;).text(value);
                self.render();
                app.dialogs.hide();
            });
        },
        /**
         * @method enableCanvasListeners
         * @returns {Prompt}
         */
        enableListeners: function() {
            this.listenTo(this.canvas, &#x27;canvas:click&#x27;, this.handleCanvasClicked);
            this.listenTo(this.canvas, &#x27;canvas:clickhold&#x27;, this.handleCanvasHeld);
            this.listenTo(this.canvas, &#x27;canvas:doubleclick&#x27;, this.handleCanvasDoubleClicked);
            this.listenTo(this.canvas, &#x27;canvas:swipeup&#x27;, this.handleCanvasSwipeUp);
            this.listenTo(this.canvas, &#x27;input:down&#x27;, this.handleInputDown);
            this.listenTo(this.canvas, &#x27;input:up&#x27;, this.handleInputUp);
            this.listenTo(this.gradingButtons, &#x27;complete&#x27;, this.handleGradingButtonsCompleted);
            this.listenTo(this.gradingButtons, &#x27;selected&#x27;, this.handleGradingButtonsSelected);
            this.listenTo(app.sidebars, &#x27;click:edit-definition&#x27;, this.editDefinition);
            this.listenTo(app.sidebars, &#x27;click:edit-mnemonic&#x27;, this.editMnemonic);
            this.listenTo(app.sidebars, &#x27;click:info-ban&#x27;, this.toggleBanned);
            this.listenTo(app.sidebars, &#x27;click:info-pleco&#x27;, this.searchPleco);
            this.listenTo(app.sidebars, &#x27;click:info-star&#x27;, this.toggleStarred);
            return this;
        },
        /**
         * @method handleGradingButtonsCompleted
         */
        handleGradingButtonsCompleted: function() {
            this.next();
        },
        /**
         * @method handleGradingButtonsSelected
         */
        handleGradingButtonsSelected: function(grade) {
            this.review.setAt(&#x27;score&#x27;, grade);
            if (app.user.settings.get(&#x27;gradingColor&#x27;)) {
                var layer = app.user.settings.get(&#x27;squigs&#x27;) ? &#x27;background&#x27; : &#x27;stroke&#x27;;
                this.canvas.injectLayerColor(layer, app.user.settings.get(&#x27;gradingColors&#x27;)[grade - 1]);
            }
        },
        /**
         * @method handlePromptClicked
         * @param {Event} event
         * @returns {Boolean}
         */
        handlePromptClicked: function(event) {
            event.preventDefault();
            return app.sidebars &amp;&amp; app.sidebars.isCollapsed() &amp;&amp; this.promptClick ? true : false;
        },
        /**
         * @method handleReadingButtonClicked
         * @param {Event} event
         */
        handleReadingButtonClicked: function(event) {
            event.preventDefault();
            $(event.currentTarget).removeClass(&#x27;reading-button&#x27;);
            $(event.currentTarget).find(&#x27;span&#x27;).removeClass(&#x27;invisible&#x27;);
        },
        /**
         * @method handleSwipedLeft
         * @param {Event} event
         */
        handleSwipedLeft: function(event) {
            event.preventDefault();
            app.analytics.trackEvent(&#x27;Prompt&#x27;, &#x27;swipeleft&#x27;, &#x27;info&#x27;);
            if (this.review) {
                this.review.setAt(&#x27;score&#x27;, 1);
            }
            app.sidebars.select(&#x27;info&#x27;).show();
        },
        /**
         * @method handleWrongButtonClicked
         * @param {Event} event
         * @returns {Boolean}
         */
        handleWrongButtonClicked: function(event) {
            event.stopPropagation();
            event.preventDefault();
            return app.sidebars &amp;&amp; app.sidebars.isCollapsed() &amp;&amp; this.promptClick ? true : false;
        },
        /**
         * @method hideNavigation
         * @param {Number} [opacity]
         * @returns {Prompt}
         */
        hideNavigation: function() {
            this.controller.elements.navigateNext.hide();
            this.controller.elements.navigatePrevious.hide();
            return this;
        },
        /**
         * @method next
         */
        next: function() {
            this.updateReview();
            if (!this.review.getAt(&#x27;answered&#x27;)) {
                this.renderAnswer();
            } else if (this.review.isLast()) {
                this.controller.triggerPromptComplete(this.review);
            } else {
                this.review.next();
                this.render();
            }
        },
        /**
         * @method previous
         */
        previous: function() {
            this.updateReview();
            if (this.review.isFirst()) {
                this.controller.triggerPrevious();
            } else {
                this.review.previous();
                this.render();
            }
        },
        /**
         * @method reset
         * @returns {Prompt}
         */
        reset: function() {
            this.stopListening();
            this.enableListeners();
            return this;
        },
        /**
         * @method resize
         * @returns {Prompt}
         */
        resize: function() {
            this.scaleText();
            return this;
        },
        /**
         * @method scaleDefinition
         * @returns {Prompt}
         */
        scaleDefinition: function() {
            //TODO: dynamically scale definitions so they fit better
            //var definitionLength = this.vocab.getDefinition().length;
            //this.$(&#x27;.text-definition&#x27;).css(&#x27;font-size&#x27;);
            return this;
        },
        /**
         * @method scaleText
         * @returns {Prompt}
         */
        scaleText: function() {
            var canvasSize = this.canvas.getWidth();
            var writingLength = this.vocab.get(&#x27;writing&#x27;).split(&#x27;&#x27;).length;
            $(&#x27;.text-max&#x27;).css(&#x27;font-size&#x27;, canvasSize / 10);
            $(&#x27;.text-large&#x27;).css(&#x27;font-size&#x27;, canvasSize / 14);
            $(&#x27;.text-normal&#x27;).css(&#x27;font-size&#x27;, canvasSize / 16);
            $(&#x27;.text-small&#x27;).css(&#x27;font-size&#x27;, canvasSize / 18);
            $(&#x27;.text-tiny&#x27;).css(&#x27;font-size&#x27;, canvasSize / 22);
            $(&#x27;.text-xtiny&#x27;).css(&#x27;font-size&#x27;, canvasSize / 30);
            $(&#x27;.text-xxtiny&#x27;).css(&#x27;font-size&#x27;, canvasSize / 40);
            if (writingLength &lt; 3) {
                this.$(&#x27;.text-max-character&#x27;).css(&#x27;font-size&#x27;, canvasSize / 5);
            } else if (writingLength &lt; 5) {
                this.$(&#x27;.text-max-character&#x27;).css(&#x27;font-size&#x27;, canvasSize / 6);
            } else if (writingLength &lt; 7) {
                this.$(&#x27;.text-max-character&#x27;).css(&#x27;font-size&#x27;, canvasSize / 8);
            } else {
                this.$(&#x27;.text-max-character&#x27;).css(&#x27;font-size&#x27;, canvasSize / 12);
            }
            return this;
        },
        /**
         * @method searchPleco
         */
        searchPleco: function() {
            if (plugins.core) {
                plugins.core.openPleco(this.vocab.get(&#x27;writing&#x27;));
            }
        },
        /**
         * @method showNavigation
         * @param {Number} [opacity]
         * @returns {Prompt}
         */
        showNavigation: function(opacity) {
            opacity = opacity === undefined ? 0.4 : opacity;
            var bottom = 75;
            var bottomOffset = 15;
            if (this.part === &#x27;rune&#x27; || this.part ===&#x27;tone&#x27;) {
                if (this.review.getAt(&#x27;answered&#x27;)) {
                    this.controller.elements.navigateNext.css({
                        bottom: this.gradingButtons.isExpanded() ? bottom : bottomOffset,
                        display: &#x27;block&#x27;,
                        opacity: opacity
                    });
                } else {
                    this.controller.elements.navigateNext.hide();
                }
                if (app.user.reviews.previous || !this.review.isFirst()) {
                    this.controller.elements.navigatePrevious.css({
                        bottom: this.gradingButtons.isExpanded() ? bottom : bottomOffset,
                        display: &#x27;block&#x27;,
                        opacity: opacity
                    });
                } else {
                    this.controller.elements.navigatePrevious.hide();
                }
            } else {
                if (this.review.getAt(&#x27;answered&#x27;)) {
                    this.controller.elements.navigateNext.css({
                        bottom: this.gradingButtons.isExpanded() ? bottom : bottomOffset,
                        display: &#x27;block&#x27;,
                        opacity: opacity
                    });
                } else {
                    this.controller.elements.navigateNext.hide();
                }
                if (app.user.reviews.previous || !this.review.isFirst()) {
                    this.controller.elements.navigatePrevious.css({
                        bottom: this.gradingButtons.isExpanded() ? bottom : bottomOffset,
                        display: &#x27;block&#x27;,
                        opacity: opacity
                    });
                } else {
                    this.controller.elements.navigatePrevious.hide();
                }
            }
            return this;
        },
        /**
         * @method teach
         * @returns {Prompt}
         */
        teach: function() {
            return this;
        },
        /**
         * @method toggleBanned
         */
        toggleBanned: function() {
            if (this.vocab.isBanned()) {
                this.vocab.set(&#x27;bannedParts&#x27;, []);
                this.elements.infoBan.addClass(&#x27;text-danger&#x27;);
            } else {
                this.vocab.set(&#x27;bannedParts&#x27;, app.user.settings.getAllParts());
                this.elements.infoBan.removeClass(&#x27;text-danger&#x27;);
            }
            this.updateVocabSidebar();
        },
        /**
         * @method toggleStarred
         */
        toggleStarred: function() {
            if (this.vocab.isStarred()) {
                this.vocab.set(&#x27;starred&#x27;, false);
            } else {
                this.vocab.set(&#x27;starred&#x27;, true);
            }
            this.updateVocabSidebar();
        },
        /**
         * @method updateVocabSidebar
         * @returns {Prompt}
         */
        updateVocabSidebar: function() {
            this.elements.infoDefinition.html(this.vocab.getDefinition());
            if (app.user.settings.get(&#x27;showHeisig&#x27;) &amp;&amp; this.vocab.has(&#x27;heisigDefinition&#x27;)) {
                this.elements.infoHeisig.text(this.vocab.get(&#x27;heisigDefinition&#x27;));
                this.elements.infoHeisig.parent().show();
            } else {
                this.elements.infoHeisig.empty();
                this.elements.infoHeisig.parent().hide();
            }
            if (this.containedVocab.get(&#x27;kana&#x27;)) {
                this.elements.infoMnemonic.parent().hide();
            } else {
                if (this.containedVocab.get(&#x27;mnemonic&#x27;)) {
                    this.elements.infoMnemonic.html(this.containedVocab.getMnemonicText());
                } else {
                    this.elements.infoMnemonic.html(&#x27;&#x27;);
                    this.elements.infoMnemonic.parent().find(&#x27;button&#x27;).text(&#x27;Add Mnemonic&#x27;);
                }
            }
            this.elements.infoReading.html(this.vocab.getReading(null, {
                style: app.user.settings.get(&#x27;readingStyle&#x27;)
            }));
            this.elements.infoWriting.html(this.vocab.getWriting());
            if (this.vocab.getContainedVocabs().length &gt; 1) {
                this.elements.infoContained.parent().show();
                this.elements.infoContained.html(this.vocab.getContainedRows());
            } else {
                this.elements.infoContained.parent().hide();
            }
            if (this.vocab.getCharacterCount() === 1 &amp;&amp; this.vocab.getDecomp()) {
                this.elements.infoDecomps.parent().show();
                this.elements.infoDecomps.html(this.vocab.getDecomp().getChildrenRows());
            } else {
                this.elements.infoDecomps.parent().hide();
            }
            if (this.vocab.isBanned()) {
                this.elements.infoBan.addClass(&#x27;fa-star text-danger&#x27;);
                this.elements.infoBan.removeClass(&#x27;text-muted&#x27;);
            } else {
                this.elements.infoBan.addClass(&#x27;text-muted&#x27;);
                this.elements.infoBan.removeClass(&#x27;fa-star text-danger&#x27;);
            }
            if (this.vocab.isStarred()) {
                this.elements.infoStar.addClass(&#x27;fa-star text-warning&#x27;);
                this.elements.infoStar.removeClass(&#x27;fa-star-o&#x27;);
            } else {
                this.elements.infoStar.addClass(&#x27;fa-star-o&#x27;);
                this.elements.infoStar.removeClass(&#x27;fa-star text-warning&#x27;);
            }
            if (app.isNative() &amp;&amp; this.vocab.isChinese()) {
                this.elements.infoPleco.show();
            } else {
                this.elements.infoPleco.hide();
            }
            app.sidebars.loadFont();
            return this;
        },
        /**
         * @method updateReview
         * @returns {Prompt}
         */
        updateReview: function() {
            this.review.setAt({
                reviewTime: app.timer.getReviewTime(),
                score: this.gradingButtons.getScore(),
                thinkingTime: app.timer.getThinkingTime()
            });
            return this;
        }
    });

    return Prompt;
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
